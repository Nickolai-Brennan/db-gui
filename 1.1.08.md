## Step 1.1.08 — Fix Actions Engine (Guided Remediation) (exact)

Goal: turn checklist failures into **safe, guided fixes**.

Fix actions never auto‑apply silently.
They always:
- show SQL preview
- run preflight (if needed)
- require explicit confirmation

---

# 1.1.08a) Fix action contract

```ts
export interface FixActionContext {
  snapshot: CatalogSnapshot;
  targetRef: TargetRef;
}

export interface FixAction {
  id: string;
  label: string;
  generate(ctx: FixActionContext): {
    sql: string;
    risk: "low" | "medium" | "high";
    notes?: string;
  };
}
```

---

# 1.1.08b) Required fix actions (v1)

Implement:
- `AUTO_CREATE_INDEX`
- `OPEN_VIOLATIONS`
- `OPEN_TABLE_KEYS_EDITOR`
- `OPEN_RELATIONSHIP_EDITOR`

Rules:
- OPEN_* actions are navigational (no SQL)
- AUTO_CREATE_INDEX generates SQL only

---

# 1.1.08c) AUTO_CREATE_INDEX behavior

Input:
- relationship TargetRef

Output:
```sql
CREATE INDEX CONCURRENTLY idx_<table>_<cols>
ON schema.table(col1, col2);
```

Rules:
- respect FK column order
- warn if table is large
- never auto‑apply in prod without confirmation

---

# 1.1.08d) Execution flow

1) User clicks Fix
2) SQL preview shown
3) Preflight run (if applicable)
4) User confirms
5) SQL executed
6) New snapshot captured
7) Checklist re‑runs

---

# Done criteria for 1.1.08

✅ Fix actions appear consistently in UI  
✅ SQL preview always visible  
✅ No fix mutates DB without confirmation  
✅ Successful fix clears checklist issue after refresh

---
